import{_ as i,c as s,a,o as n}from"./app-LjtWi_AK.js";const l={};function p(r,e){return n(),s("div",null,[...e[0]||(e[0]=[a(`<h1 id="php扩展安装" tabindex="-1"><a class="header-anchor" href="#php扩展安装"><span>php扩展安装</span></a></h1><h2 id="情境" tabindex="-1"><a class="header-anchor" href="#情境"><span>情境</span></a></h2><p>​ <em>源码安装redis扩展</em></p><h2 id="解决方法" tabindex="-1"><a class="header-anchor" href="#解决方法"><span>解决方法</span></a></h2><ul><li><p>下载redis的安装包</p><p>地址：<a href="https://github.com/phpredis/phpredis/archive/5.1.1.tar.gz" target="_blank" rel="noopener noreferrer">https://github.com/phpredis/phpredis/archive/5.1.1.tar.gz</a> 扩展下载地址：<a href="https://pecl.php.net/" target="_blank" rel="noopener noreferrer">https://pecl.php.net/</a></p></li><li><p>使用tar命令解压到指定目录，并进入文件夹</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>tar zcxf phpredis-5.1.1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>查看扩展目录</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>在phpinfo的结果中，搜索extension_dir找到扩展目录</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>生成 .configure文件</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>phpize</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>编译到指定目录</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span> ./configure --with-php-config=/usr/lib64/php/modules</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>安装</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>make install</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>配置扩展信息</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>extension=redis.so</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>php -m 查看</p><p>注意：如果使用nginx代理的服务查看扩展的话，需要重启nginx和php-fpm</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>nginx -s stop //停止nginx</span></span>
<span class="line"><span>nginx   //开启nginx</span></span>
<span class="line"><span>pkill php-fpm //停止php-fpm</span></span>
<span class="line"><span>php-fpm -R  //重启或启动php-fpm</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h2 id="注意" tabindex="-1"><a class="header-anchor" href="#注意"><span>注意</span></a></h2><blockquote><p>如报错: PHP Warning: PHP Startup: Unable to load dynamic library &#39;/usr/lib64/php/modules/redis.so&#39; - /usr/lib64/php/modules/redis.so: undefined symbol: php_json_decode_ex in Unknown on line 0</p></blockquote><ul><li><h3 id="原因" tabindex="-1"><a class="header-anchor" href="#原因"><span>原因</span></a></h3><p>这是因为和json扩展加载顺序冲突导致的</p></li><li><h3 id="解决" tabindex="-1"><a class="header-anchor" href="#解决"><span>解决</span></a></h3><p>不要在php.ini里加入extension=redis.so这行，可在php.d文件夹下创建新文件redis.ini，在redis.ini里加入extension=redis.so这行. 重启php php -m 发现redis扩展加载上了</p></li></ul>`,8)])])}const d=i(l,[["render",p]]),t=JSON.parse('{"path":"/linux/php-pecl.html","title":"php扩展安装","lang":"zh-CN","frontmatter":{"date":"2019-12-27T00:00:00.000Z","category":"后端","tag":["linux","php"]},"git":{"createdTime":1759144434000,"updatedTime":1759144434000},"readingTime":{"minutes":0.91,"words":274},"filePathRelative":"linux/php-pecl.md"}');export{d as comp,t as data};
